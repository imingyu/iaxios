{"version":3,"file":"iaxios.js","sources":["../src/util.js","../src/feature.js","../src/process.js","../src/options.js","../src/index.js"],"sourcesContent":["import Qs from 'qs';\nexport var paramsSerializer = obj => {\n    return Qs.stringify(obj, { arrayFormat: 'brackets' });//如何序列化params，params会拼接的url后面\n}\nexport var stringifyData = obj => {\n    return Qs.stringify(obj);\n}\n\nexport var isPromise = obj => {\n    return obj && obj.then && obj.catch;\n}\n\nexport var uniqueID = () => {\n    return (Math.random() + '').replace('0.', '');\n}\n\nexport var getValue = (propExp, obj) => {\n    try {\n        var fun = new Function('obj', 'var result;try{result=obj.' + propExp + ';}catch(error){};return result;');\n        return fun(obj);\n    } catch (error) {\n    }\n};\n\nexport var validOptions = ops => {\n    if (typeof ops === 'object') {\n        var msg = item => {\n            return `${item}必需是object类型`;\n        }\n        if (ops.hasOwnProperty('features') && typeof ops.features !== 'object') {\n            throw new TypeError(msg('options.features'));\n        }\n        if (ops.hasOwnProperty('requestConfigList') && typeof ops.requestConfigList !== 'object') {\n            throw new TypeError(msg('options.requestConfigList'));\n        }\n        if (ops.hasOwnProperty('axios') && typeof ops.axios !== 'object') {\n            throw new TypeError(msg('options.axios'));\n        }\n        if (ops.hasOwnProperty('validators') && typeof ops.validators !== 'object') {\n            throw new TypeError(msg('options.validators'));\n        }\n        if (ops.hasOwnProperty('handlers') && typeof ops.handlers !== 'object') {\n            throw new TypeError(msg('options.handlers'));\n        }\n    }\n}\n\nexport var standardAuthOptions = item => {\n    var vi;\n    if (typeof item === 'object') {\n        vi = item;\n    } else if (typeof item === 'function') {\n        vi = {\n            handler: item\n        };\n    } else {\n        vi = {\n            enabled: item\n        };\n    }\n    return vi;\n}\n\nexport var standardFeaturesOptions = ops => {\n    if (ops && typeof ops.features === 'object') {\n        Object.keys(ops.features).forEach(key => {\n            var val = ops.features[key];\n            if (typeof val === 'undefined' || val == null) {\n                delete ops.features[key];\n            } else if (typeof val === 'boolean') {\n                ops.features[key] = {\n                    enabled: val\n                }\n            }\n        })\n    }\n    return ops;\n}\n\nexport var standardRequestConfigItem = (cfg) => {\n    if (!cfg) return;\n    if (typeof cfg === 'object') {\n        standardFeaturesOptions(cfg);\n        var result = {\n                features: cfg.features,\n                handlers: cfg.handlers || {},\n                requestConfigList: undefined,\n                axios: undefined,\n                validators: undefined\n            },\n            axiosOps = {};\n\n        Object.keys(cfg).forEach(item => {\n            if (!result.hasOwnProperty(item)) {\n                axiosOps[item] = cfg[item];\n            }\n        });\n        result.axios = axiosOps;\n        return result;\n    }\n    return cfg;\n}\n\nexport var standardOptions = (ops) => {\n    if (!ops || typeof ops !== 'object' || ops === null) return;\n    standardFeaturesOptions(ops);\n    return ops;\n}\n\n// jQuery版extend函数\nexport var extend = function () {\n    var options, name, src, copy, copyIsArray, clone, target = arguments[0] || {},\n        i = 1,\n        length = arguments.length,\n        deep = false,\n        toString = Object.prototype.toString,\n        hasOwn = Object.prototype.hasOwnProperty,\n        class2type = {\n            '[object Boolean]': 'boolean',\n            '[object Number]': 'number',\n            '[object String]': 'string',\n            '[object Function]': 'function',\n            '[object Array]': 'array',\n            '[object Date]': 'date',\n            '[object RegExp]': 'regexp',\n            '[object Object]': 'object'\n        },\n        jQuery = {\n            isFunction: function (obj) {\n                return jQuery.type(obj) === 'function'\n            },\n            isArray: Array.isArray ||\n            function (obj) {\n                return jQuery.type(obj) === 'array'\n            },\n            isWindow: function (obj) {\n                return obj != null && obj == obj.window\n            },\n            isNumeric: function (obj) {\n                return !isNaN(parseFloat(obj)) && isFinite(obj)\n            },\n            type: function (obj) {\n                return obj == null ? String(obj) : class2type[toString.call(obj)] || 'object'\n            },\n            isPlainObject: function (obj) {\n                if (!obj || jQuery.type(obj) !== 'object' || obj.nodeType) {\n                    return false\n                }\n                try {\n                    if (obj.constructor && !hasOwn.call(obj, 'constructor') && !hasOwn.call(obj.constructor.prototype, 'isPrototypeOf')) {\n                        return false\n                    }\n                } catch (e) {\n                    return false\n                }\n                var key;\n                for (key in obj) { }\n                return key === undefined || hasOwn.call(obj, key)\n            }\n        };\n    if (typeof target === 'boolean') {\n        deep = target;\n        target = arguments[1] || {};\n        i = 2;\n    }\n    if (typeof target !== 'object' && !jQuery.isFunction(target)) {\n        target = {}\n    }\n    if (length === i) {\n        target = this;\n        --i;\n    }\n    for (i; i < length; i++) {\n        if ((options = arguments[i]) != null) {\n            for (name in options) {\n                src = target[name];\n                copy = options[name];\n                if (target === copy) {\n                    continue\n                }\n                if (deep && copy && (jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)))) {\n                    if (copyIsArray) {\n                        copyIsArray = false;\n                        clone = src && jQuery.isArray(src) ? src : []\n                    } else {\n                        clone = src && jQuery.isPlainObject(src) ? src : {};\n                    }\n                    // WARNING: RECURSION\n                    target[name] = extend(deep, clone, copy);\n                } else if (copy !== undefined) {\n                    target[name] = copy;\n                }\n            }\n        }\n    }\n    return target;\n}\n","import axios from 'axios';\nimport * as util from './util.js';\n\nconst stages = ['before', 'sending', 'after'];\n\nvar check = (feature, checkData, resolve, process) => {\n    var checkResult = feature.checker(checkData, process),\n        stage = `${feature.stage}.${feature.name}`;\n    if (typeof checkResult === 'undefined') {\n        console.log(process);\n    }\n    if (util.isPromise(checkResult)) {\n        checkResult.then(result => {\n            resolve({\n                state: result ? 'resolve' : 'reject',\n                stage: stage,\n                data: checkData\n            });\n        }).catch(() => {\n            resolve({\n                state: 'reject',\n                stage: stage,\n                data: checkData\n            });\n        })\n    } else {\n        resolve({\n            state: checkResult ? 'resolve' : 'reject',\n            stage: stage,\n            data: checkData\n        });\n    }\n}\n\nclass Feature {\n    constructor(name, stage, handler, checker, beforeReject) {\n        stage = stage || '';\n        stage = stage.toLowerCase();\n        this.name = name;\n        this.stage = stages.indexOf(stage) != -1 ? stage : 'before';\n        this.handler = handler;\n        this.checker = typeof checker === 'function' ? checker : function (result) {\n            return result;\n        };\n        this.beforeReject = typeof beforeReject === 'function' ? beforeReject : function () { };\n    }\n\n    exec(process) {\n        var self = this,\n            args = Array.from(arguments);\n        return new Promise((resolve, reject) => {\n            var result = self.handler.apply(self, args),\n                stage = `${self.stage}.${self.name}`;\n            if (util.isPromise(result)) {\n                result.then(data => {\n                    check(self, data, resolve, process);\n                }).catch(error => {\n                    if (axios.isCancel(error)) {\n                        stage = 'cancel';\n                    }\n                    resolve({\n                        state: 'reject',\n                        stage: stage,\n                        data: error\n                    });\n                })\n            } else {\n                check(self, result, resolve, process);\n            }\n        });\n    }\n}\n\nFeature.map = {};\n\n//认证功能\nFeature.map['auth'] = new Feature('auth', 'before', function (process) {\n    var authOps = process.featureOptions.auth;\n    if (authOps && typeof authOps.handler === 'function') {\n        return authOps.handler(process.requestItemConfig, process.requestArgs);\n    } else {\n        return true;\n    }\n}, null, function (process) {\n    var authOps = process.featureOptions.auth;\n    if (typeof authOps.onUnAuth === 'function') {\n        authOps.onUnAuth(process.requestItemConfig, process.requestArgs);\n    }\n});\n\n//validator功能\nvar validatorFeature = new Feature('validator', 'before', function (process) {\n    var requestConfig = process.requestItemConfig,\n        vsAll = process.computeOptions.validators || {},\n        vsConfig = process.featureOptions.validator,\n        vsRequest = vsAll[process.requestName], //request对应的验证器\n        execValidators = [];\n\n    if (typeof vsRequest === 'function') {\n        execValidators.push(vsRequest)\n    } else if (Array.isArray(vsRequest)) {\n        execValidators = execValidators.concat(vsRequest);\n    }\n    if (typeof vsConfig === 'function') {\n        execValidators.push(vsConfig)\n    } else if (Array.isArray(vsConfig)) {\n        execValidators = execValidators.concat(vsConfig);\n    } else if (typeof vsConfig === 'object' && vsConfig.enabled && vsConfig.validators) {\n        execValidators = execValidators.concat(vsConfig.validators || []);\n    }\n\n    return Promise.all(execValidators.map(item => {\n        var itemResult = item(requestConfig, process.requestArgs);\n        if (util.isPromise(itemResult)) {\n            return itemResult;\n        } else {\n            return Promise.resolve(itemResult);\n        }\n    }));\n}, function (datas, process) {\n    var vsConfig = process.featureOptions.validator,\n        checkHanlder = vsConfig.checkHanlder;\n    if (typeof checkHanlder === 'function') {\n        return checkHanlder(datas);\n    } else {\n        return true;\n    }\n}, function (process) {\n    var vsConfig = process.featureOptions.validator,\n        onUnValid = vsConfig.onUnValid;\n    if (typeof onUnValid === 'function') {\n        var validatorData = process.dataMap.find(item => item.stage === 'before.validator');\n        return onUnValid(validatorData ? validatorData.data : undefined);\n    }\n});\nFeature.map[validatorFeature.name] = validatorFeature;\n\n//发送请求功能\nconst senderFeature = new Feature('sender', 'sending', function (process) {\n    var iaxios = process.iaxios,\n        requestName = process.requestName,\n        requestConfig = process.requestItemConfig,\n        ajaxOptions = process.computeOptions.axios,\n        handlers = process.computeOptions.handlers;\n\n    //3.获取请求的真实url：getUrl\n    if (typeof handlers.getUrl === 'function') {\n        var computedUrl = handlers.getUrl(requestConfig);\n        if (computedUrl) {\n            ajaxOptions.url = computedUrl + '';\n        } else {\n            ajaxOptions.url = requestConfig.url;\n        }\n    }\n    if (!ajaxOptions.url || String.prototype.trim.call(ajaxOptions.url) === '') {\n        ajaxOptions.url = requestName + '';\n    }\n\n    //4.应用计算后的axios配置信息：axios.request\n    var cancelTokenSource = axios.CancelToken.source();\n    ajaxOptions.cancelToken = cancelTokenSource.token;\n    var requestModel = process.requestArgs && process.requestArgs.length > 0 ? process.requestArgs[0] : {};\n    if ((ajaxOptions.method + '').toLowerCase() === 'get') {\n        ajaxOptions.params = ajaxOptions.params || {};\n        if (typeof ajaxOptions.params === 'object') {\n            util.extend(true, ajaxOptions.params, requestModel);\n        } else if (typeof ajaxOptions.params === 'string') {\n            ajaxOptions.params += '&' + util.paramsSerializer(requestModel);\n        }\n    } else {\n        if (typeof requestModel === 'string' && requestModel != '') {\n            if (typeof ajaxOptions.data === 'string') {\n                ajaxOptions.data += '&' + util.stringifyData(requestModel);\n            } else if (typeof ajaxOptions.data === 'object') {\n                ajaxOptions.data = util.stringifyData(requestModel) + '&' + requestModel;\n            } else {\n                ajaxOptions.data = requestModel;\n            }\n        } else if (typeof requestModel === 'object') {\n            if (typeof ajaxOptions.data === 'object') {\n                util.extend(true, ajaxOptions.data, requestModel);\n            } else if (typeof ajaxOptions.data === 'string') {\n                ajaxOptions.data += '&' + util.stringifyData(requestModel);\n            } else {\n                ajaxOptions.data = requestModel;\n            }\n        }\n    }\n    process.cancelToken = cancelTokenSource;\n\n    //5.开始发送请求\n    return iaxios.axios.request(ajaxOptions);\n}, function (res, process) {\n    var handlerCheckResult = process.computeOptions.handlers.checkResult;\n    var result = (handlerCheckResult || function () { return true })(res);\n    return result;\n});\nFeature.map[senderFeature.name] = senderFeature;\n\nexport default Feature;\n","import Feature from './feature.js';\nimport * as util from './util.js';\n\nvar defaultConvert = data => {\n    return data;\n}\n\nvar getConvert = (name, process) => {\n    var handlers = process.computeOptions.handlers,\n        convert = handlers ? handlers[name] : null;\n    convert = typeof convert === 'function' ? convert : defaultConvert;\n    return convert;\n}\n\nexport default class Process {\n    constructor() {\n        this.stack = [];\n        this.iaxios = null;\n        this.otherOptions = null;\n        this.requestName = '';\n        this.requestArgs = null;\n        this.isCancel = false;\n        this.dataMap = [];\n        this.cancelToken = null;\n    }\n\n    run() {\n        //执行run函数后，即锁定当前配置中的Feature，解释后续再有功能的配置变化，也不会执行，函数除外\n        var process = this;\n        process.requestItemConfig = process.iaxios.options.requestConfigList[process.requestName];\n        process.computeOptions = util.extend(true, {}, process.iaxios.options, util.standardRequestConfigItem(process.requestItemConfig), process.otherOptions, process.sendOptions);\n\n        function CancelPromise(executor) {\n            var p = new Promise(function (resolve, reject) {\n                return executor(resolve, reject);\n            });\n            /*eslint no-proto: 0*/\n            p.__proto__ = CancelPromise.prototype;\n            return p;\n        }\n        CancelPromise.__proto__ = Promise;\n        CancelPromise.prototype.__proto__ = Promise.prototype;\n        CancelPromise.prototype.cancel = function (data) {\n            return process.cancel(data);\n        }\n\n        var promise = new CancelPromise((resolve, reject) => {\n            var orgFeatures = process.computeOptions.features;\n            var keys = Object.keys(orgFeatures).filter(name => {\n                var f = orgFeatures[name];\n                return !!f.enabled;//只抓取已启用的功能\n            });\n            var features = keys.map(name => {\n                return Feature.map[name];\n            }).filter(f => {\n                return !!f;\n            });\n            features.push(Feature.map['sender']);\n            features = features.filter(f => f.stage === 'before').concat(features.filter(f => f.stage === 'sending'), features.filter(f => f.stage === 'after'))\n\n            //将功能实例赋值到process上\n            process.featureInstances = features;\n            process.featureOptions = orgFeatures;\n\n            features.forEach(featureIns => {\n                process.use(function (next) {\n                    if (process.isCancel) {\n                        reject(getConvert('rejectConvert', process)(process.dataMap, process.requestItemConfig));\n                        return;\n                    }\n\n                    featureIns.exec(process).then(data => {\n                        process.dataMap.push(data);\n                        if (data.state === 'resolve') {\n                            if (featureIns.requiredResolve) {\n                                if (typeof featureIns.breforeResolve === 'function') {\n                                    featureIns.breforeResolve(process);\n                                }\n                                resolve(getConvert('resolveConvert', process)(data.data, process.requestItemConfig));\n                            } else {\n                                if (process.stack.length > 0) {\n                                    next();\n                                } else {\n                                    resolve(getConvert('resolveConvert', process)(data.data, process.requestItemConfig));\n                                }\n                            }\n                        } else {\n                            if (typeof featureIns.beforeReject === 'function') {\n                                featureIns.beforeReject(process);\n                            }\n                            reject(getConvert('rejectConvert', process)(process.dataMap, process.requestItemConfig));\n                        }\n                    });\n                })\n            });\n            process.next();\n        });\n        return promise;\n    }\n\n    cancel(data) {\n        if (this.isCancel) return;\n        this.isCancel = true;\n        if (this.cancelToken) {\n            this.cancelToken.cancel(data);\n        }\n    }\n    use(handler) {\n        if (typeof handler !== 'function') return;\n        this.stack.push(handler);\n    }\n\n    next() {\n        var item = this.stack.shift();\n        if (item) {\n            item(this.next.bind(this));\n        }\n    }\n}\n","import * as util from './util.js';\nexport default {\n    requestConfigList: {}, //request配置元信息集合\n    axios: {\n        //axios配置\n        method: 'get',\n        paramsSerializer: util.paramsSerializer,\n        headers: {\n            common: {\n                'Content-Type': 'application/json'\n            },\n            post: {\n                'Content-Type': 'application/x-www-form-urlencoded'\n            }\n        },\n        transformRequest: [function (data, headers) {\n            return util.stringifyData(data);\n        }]\n    },\n    validators: {}, //验证器列表\n    features: { //启用iaxios的哪些功能？\n        auth: {\n            enabled: false\n        },\n        jsonp: {\n            enabled: false\n        }, //接口是否以jsonp方式发送\n        validator: {\n            enabled: false\n        }//启用验证器，调用iaxios.createRequest()返回的方法时，先取request配置中的验证器去验证参数，验证通过才会执行下面的逻辑\n    },\n    handlers: {\n        //获取请求的真实url\n        getUrl(requestConfig) {\n            return requestConfig.url;\n        },\n        //检查请求返回的结果，成功请resolve，失败请reject\n        checkResult(res, requestConfig) {\n            return res && res.data ? true : false;\n        },\n        //格式化请求成功的数据\n        resolveConvert(res, requestConfig) {\n            return res.data;\n        },\n        //格式化请求失败的数据\n        rejectConvert(rejectDataMap, requestConfig) {\n            return rejectDataMap;\n        }\n    }\n};\n","import axios from 'axios';\nimport Process from './process.js';\nimport * as util from './util.js';\nimport defaultIAxiosOptions from './options.js';\n\n/**\n * request发送流程：\n * 1.检查认证：auth\n * 2.验证参数：validator\n * 3.获取请求的真实url：getUrl\n * 4.应用计算后的axios配置信息：axios.request\n * 5.开始发送请求\n * 6.检查请求结果：checkResult\n * 7.格式化请求结果数据：成功：resolveConvert，失败：rejectConvert，取消：cancelConvert，未认证：unAuthConvert\n * 8.将处理的数据传递给后续函数处理：then/catch\n * 9.流程结束\n */\n\nclass IAxios {\n    constructor(ops) {\n        this.id = (Math.random() + '').replace('0.', '');\n        IAxios.map[this.id] = this;\n\n        //创建一个axios实例\n        this.axios = axios.create();\n\n        this.options = {};\n        this.setOptions(ops);\n    }\n    createRequest(requestName, otherOptions) {\n        var iaxiosIns = this;\n\n        return function request(model, ops) {\n            var requestArgs = Array.from(arguments),\n                process = new Process();\n            process.iaxios = iaxiosIns;\n            process.otherOptions = otherOptions;\n            process.sendOptions = ops;\n            process.sendModel = model;\n            process.requestName = requestName;\n            process.requestArgs = requestArgs;\n            process.isCancel = false;\n            process.dataMap = [];\n            process.cancelToken = null;\n\n            return process.run();\n        }\n    }\n    setOptions(ops) {\n        if (typeof ops === 'object') {\n            util.validOptions(ops);\n            util.standardFeaturesOptions(ops);\n            util.extend(true, this.options, ops);\n        }\n    }\n    static create(ops) {\n        return new IAxios(util.extend(true, {}, defaultIAxiosOptions, ops));\n    }\n    static createRequest(requestName, otherOptions) {\n        return IAxios.map['default'].createRequest(requestName, otherOptions);\n    }\n    static setOptions(ops) {\n        if (typeof ops === 'object') {\n            util.validOptions(ops);\n            util.standardFeaturesOptions(ops);\n            util.extend(true, defaultIAxiosOptions, ops);\n            IAxios.map['default'].setOptions(ops);\n        }\n    }\n}\nIAxios.map = {};\n\nvar defaultIAxios = IAxios.create();\ndefaultIAxios.id = 'default';\nIAxios.map['default'] = defaultIAxios;\n\nexport default IAxios;\n"],"names":["paramsSerializer","Qs","stringify","obj","arrayFormat","stringifyData","isPromise","then","catch","validOptions","ops","msg","item","hasOwnProperty","babelHelpers.typeof","features","TypeError","requestConfigList","axios","validators","handlers","standardFeaturesOptions","keys","forEach","val","key","standardRequestConfigItem","cfg","result","undefined","axiosOps","extend","options","name","src","copy","copyIsArray","clone","target","arguments","i","length","deep","toString","Object","prototype","hasOwn","class2type","jQuery","type","Array","isArray","window","isNaN","parseFloat","isFinite","String","call","nodeType","constructor","e","isFunction","isPlainObject","stages","check","feature","checkData","resolve","process","checkResult","checker","stage","log","util","Feature","handler","beforeReject","toLowerCase","indexOf","self","args","from","Promise","reject","apply","data","isCancel","error","map","authOps","featureOptions","auth","requestItemConfig","requestArgs","onUnAuth","validatorFeature","requestConfig","vsAll","computeOptions","vsConfig","validator","vsRequest","requestName","push","execValidators","concat","enabled","all","itemResult","datas","checkHanlder","onUnValid","validatorData","dataMap","find","senderFeature","iaxios","ajaxOptions","getUrl","computedUrl","url","trim","cancelTokenSource","CancelToken","source","cancelToken","token","requestModel","method","params","request","res","handlerCheckResult","defaultConvert","getConvert","convert","Process","stack","otherOptions","sendOptions","CancelPromise","executor","p","__proto__","cancel","promise","orgFeatures","filter","f","featureInstances","use","next","exec","state","featureIns","requiredResolve","breforeResolve","shift","bind","headers","rejectDataMap","IAxios","id","Math","random","replace","create","setOptions","iaxiosIns","model","sendModel","run","defaultIAxiosOptions","createRequest","defaultIAxios"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACO,IAAIA,mBAAmB,SAAnBA,gBAAmB,MAAO;WAC1BC,GAAGC,SAAH,CAAaC,GAAb,EAAkB,EAAEC,aAAa,UAAf,EAAlB,CAAP,CADiC;CAA9B;AAGP,AAAO,IAAIC,gBAAgB,SAAhBA,aAAgB,MAAO;WACvBJ,GAAGC,SAAH,CAAaC,GAAb,CAAP;CADG;;AAIP,AAAO,IAAIG,YAAY,SAAZA,SAAY,MAAO;WACnBH,OAAOA,IAAII,IAAX,IAAmBJ,IAAIK,KAA9B;CADG;;AAIP;;AAIA;;AAQA,AAAO,IAAIC,eAAe,SAAfA,YAAe,MAAO;QACzB,QAAOC,GAAP,yCAAOA,GAAP,OAAe,QAAnB,EAA6B;YACrBC,MAAM,SAANA,GAAM,OAAQ;mBACJC,IAAV;SADJ;YAGIF,IAAIG,cAAJ,CAAmB,UAAnB,KAAkCC,QAAOJ,IAAIK,QAAX,MAAwB,QAA9D,EAAwE;kBAC9D,IAAIC,SAAJ,CAAcL,IAAI,kBAAJ,CAAd,CAAN;;YAEAD,IAAIG,cAAJ,CAAmB,mBAAnB,KAA2CC,QAAOJ,IAAIO,iBAAX,MAAiC,QAAhF,EAA0F;kBAChF,IAAID,SAAJ,CAAcL,IAAI,2BAAJ,CAAd,CAAN;;YAEAD,IAAIG,cAAJ,CAAmB,OAAnB,KAA+BC,QAAOJ,IAAIQ,KAAX,MAAqB,QAAxD,EAAkE;kBACxD,IAAIF,SAAJ,CAAcL,IAAI,eAAJ,CAAd,CAAN;;YAEAD,IAAIG,cAAJ,CAAmB,YAAnB,KAAoCC,QAAOJ,IAAIS,UAAX,MAA0B,QAAlE,EAA4E;kBAClE,IAAIH,SAAJ,CAAcL,IAAI,oBAAJ,CAAd,CAAN;;YAEAD,IAAIG,cAAJ,CAAmB,UAAnB,KAAkCC,QAAOJ,IAAIU,QAAX,MAAwB,QAA9D,EAAwE;kBAC9D,IAAIJ,SAAJ,CAAcL,IAAI,kBAAJ,CAAd,CAAN;;;CAlBL;;AAuBP;;AAgBA,AAAO,IAAIU,0BAA0B,SAA1BA,uBAA0B,MAAO;QACpCX,OAAOI,QAAOJ,IAAIK,QAAX,MAAwB,QAAnC,EAA6C;eAClCO,IAAP,CAAYZ,IAAIK,QAAhB,EAA0BQ,OAA1B,CAAkC,eAAO;gBACjCC,MAAMd,IAAIK,QAAJ,CAAaU,GAAb,CAAV;gBACI,OAAOD,GAAP,KAAe,WAAf,IAA8BA,OAAO,IAAzC,EAA+C;uBACpCd,IAAIK,QAAJ,CAAaU,GAAb,CAAP;aADJ,MAEO,IAAI,OAAOD,GAAP,KAAe,SAAnB,EAA8B;oBAC7BT,QAAJ,CAAaU,GAAb,IAAoB;6BACPD;iBADb;;SALR;;WAWGd,GAAP;CAbG;;AAgBP,AAAO,IAAIgB,4BAA4B,SAA5BA,yBAA4B,CAACC,GAAD,EAAS;QACxC,CAACA,GAAL,EAAU;QACN,QAAOA,GAAP,yCAAOA,GAAP,OAAe,QAAnB,EAA6B;gCACDA,GAAxB;YACIC,SAAS;sBACKD,IAAIZ,QADT;sBAEKY,IAAIP,QAAJ,IAAgB,EAFrB;+BAGcS,SAHd;mBAIEA,SAJF;wBAKOA;SALpB;YAOIC,WAAW,EAPf;;eASOR,IAAP,CAAYK,GAAZ,EAAiBJ,OAAjB,CAAyB,gBAAQ;gBACzB,CAACK,OAAOf,cAAP,CAAsBD,IAAtB,CAAL,EAAkC;yBACrBA,IAAT,IAAiBe,IAAIf,IAAJ,CAAjB;;SAFR;eAKOM,KAAP,GAAeY,QAAf;eACOF,MAAP;;WAEGD,GAAP;CArBG;;AAwBP;;;AAOA,AAAO,IAAII,SAAS,SAATA,MAAS,GAAY;QACxBC,OAAJ;QAAaC,IAAb;QAAmBC,GAAnB;QAAwBC,IAAxB;QAA8BC,WAA9B;QAA2CC,KAA3C;QAAkDC,SAASC,UAAU,CAAV,KAAgB,EAA3E;QACIC,IAAI,CADR;QAEIC,SAASF,UAAUE,MAFvB;QAGIC,OAAO,KAHX;QAIIC,WAAWC,OAAOC,SAAP,CAAiBF,QAJhC;QAKIG,SAASF,OAAOC,SAAP,CAAiBhC,cAL9B;QAMIkC,aAAa;4BACW,SADX;2BAEU,QAFV;2BAGU,QAHV;6BAIY,UAJZ;0BAKS,OALT;yBAMQ,MANR;2BAOU,QAPV;2BAQU;KAd3B;QAgBIC,SAAS;oBACO,oBAAU7C,GAAV,EAAe;mBAChB6C,OAAOC,IAAP,CAAY9C,GAAZ,MAAqB,UAA5B;SAFC;iBAII+C,MAAMC,OAAN,IACT,UAAUhD,GAAV,EAAe;mBACJ6C,OAAOC,IAAP,CAAY9C,GAAZ,MAAqB,OAA5B;SANC;kBAQK,kBAAUA,GAAV,EAAe;mBACdA,OAAO,IAAP,IAAeA,OAAOA,IAAIiD,MAAjC;SATC;mBAWM,mBAAUjD,GAAV,EAAe;mBACf,CAACkD,MAAMC,WAAWnD,GAAX,CAAN,CAAD,IAA2BoD,SAASpD,GAAT,CAAlC;SAZC;cAcC,cAAUA,GAAV,EAAe;mBACVA,OAAO,IAAP,GAAcqD,OAAOrD,GAAP,CAAd,GAA4B4C,WAAWJ,SAASc,IAAT,CAActD,GAAd,CAAX,KAAkC,QAArE;SAfC;uBAiBU,uBAAUA,GAAV,EAAe;gBACtB,CAACA,GAAD,IAAQ6C,OAAOC,IAAP,CAAY9C,GAAZ,MAAqB,QAA7B,IAAyCA,IAAIuD,QAAjD,EAA2D;uBAChD,KAAP;;gBAEA;oBACIvD,IAAIwD,WAAJ,IAAmB,CAACb,OAAOW,IAAP,CAAYtD,GAAZ,EAAiB,aAAjB,CAApB,IAAuD,CAAC2C,OAAOW,IAAP,CAAYtD,IAAIwD,WAAJ,CAAgBd,SAA5B,EAAuC,eAAvC,CAA5D,EAAqH;2BAC1G,KAAP;;aAFR,CAIE,OAAOe,CAAP,EAAU;uBACD,KAAP;;gBAEAnC,GAAJ;iBACKA,GAAL,IAAYtB,GAAZ,EAAiB;mBACVsB,QAAQI,SAAR,IAAqBiB,OAAOW,IAAP,CAAYtD,GAAZ,EAAiBsB,GAAjB,CAA5B;;KA9CZ;QAiDI,OAAOa,MAAP,KAAkB,SAAtB,EAAiC;eACtBA,MAAP;iBACSC,UAAU,CAAV,KAAgB,EAAzB;YACI,CAAJ;;QAEA,QAAOD,MAAP,yCAAOA,MAAP,OAAkB,QAAlB,IAA8B,CAACU,OAAOa,UAAP,CAAkBvB,MAAlB,CAAnC,EAA8D;iBACjD,EAAT;;QAEAG,WAAWD,CAAf,EAAkB;iBACL,IAAT;UACEA,CAAF;;SAECA,CAAL,EAAQA,IAAIC,MAAZ,EAAoBD,GAApB,EAAyB;YACjB,CAACR,UAAUO,UAAUC,CAAV,CAAX,KAA4B,IAAhC,EAAsC;iBAC7BP,IAAL,IAAaD,OAAb,EAAsB;sBACZM,OAAOL,IAAP,CAAN;uBACOD,QAAQC,IAAR,CAAP;oBACIK,WAAWH,IAAf,EAAqB;;;oBAGjBO,QAAQP,IAAR,KAAiBa,OAAOc,aAAP,CAAqB3B,IAArB,MAA+BC,cAAcY,OAAOG,OAAP,CAAehB,IAAf,CAA7C,CAAjB,CAAJ,EAA0F;wBAClFC,WAAJ,EAAiB;sCACC,KAAd;gCACQF,OAAOc,OAAOG,OAAP,CAAejB,GAAf,CAAP,GAA6BA,GAA7B,GAAmC,EAA3C;qBAFJ,MAGO;gCACKA,OAAOc,OAAOc,aAAP,CAAqB5B,GAArB,CAAP,GAAmCA,GAAnC,GAAyC,EAAjD;;;2BAGGD,IAAP,IAAeF,OAAOW,IAAP,EAAaL,KAAb,EAAoBF,IAApB,CAAf;iBARJ,MASO,IAAIA,SAASN,SAAb,EAAwB;2BACpBI,IAAP,IAAeE,IAAf;;;;;WAKTG,MAAP;CArFG;;AC3GP,IAAMyB,SAAS,CAAC,QAAD,EAAW,SAAX,EAAsB,OAAtB,CAAf;;AAEA,IAAIC,QAAQ,SAARA,KAAQ,CAACC,OAAD,EAAUC,SAAV,EAAqBC,OAArB,EAA8BC,OAA9B,EAA0C;QAC9CC,cAAcJ,QAAQK,OAAR,CAAgBJ,SAAhB,EAA2BE,OAA3B,CAAlB;QACIG,QAAWN,QAAQM,KAAnB,SAA4BN,QAAQhC,IADxC;QAEI,OAAOoC,WAAP,KAAuB,WAA3B,EAAwC;gBAC5BG,GAAR,CAAYJ,OAAZ;;QAEAK,SAAA,CAAeJ,WAAf,CAAJ,EAAiC;oBACjB9D,IAAZ,CAAiB,kBAAU;oBACf;uBACGqB,SAAS,SAAT,GAAqB,QADxB;uBAEG2C,KAFH;sBAGEL;aAHV;SADJ,EAMG1D,KANH,CAMS,YAAM;oBACH;uBACG,QADH;uBAEG+D,KAFH;sBAGEL;aAHV;SAPJ;KADJ,MAcO;gBACK;mBACGG,cAAc,SAAd,GAA0B,QAD7B;mBAEGE,KAFH;kBAGEL;SAHV;;CArBR;;IA6BMQ;qBACUzC,IAAZ,EAAkBsC,KAAlB,EAAyBI,OAAzB,EAAkCL,OAAlC,EAA2CM,YAA3C,EAAyD;;;gBAC7CL,SAAS,EAAjB;gBACQA,MAAMM,WAAN,EAAR;aACK5C,IAAL,GAAYA,IAAZ;aACKsC,KAAL,GAAaR,OAAOe,OAAP,CAAeP,KAAf,KAAyB,CAAC,CAA1B,GAA8BA,KAA9B,GAAsC,QAAnD;aACKI,OAAL,GAAeA,OAAf;aACKL,OAAL,GAAe,OAAOA,OAAP,KAAmB,UAAnB,GAAgCA,OAAhC,GAA0C,UAAU1C,MAAV,EAAkB;mBAChEA,MAAP;SADJ;aAGKgD,YAAL,GAAoB,OAAOA,YAAP,KAAwB,UAAxB,GAAqCA,YAArC,GAAoD,YAAY,EAApF;;;;;6BAGCR,SAAS;gBACNW,OAAO,IAAX;gBACIC,OAAO9B,MAAM+B,IAAN,CAAW1C,SAAX,CADX;mBAEO,IAAI2C,OAAJ,CAAY,UAACf,OAAD,EAAUgB,MAAV,EAAqB;oBAChCvD,SAASmD,KAAKJ,OAAL,CAAaS,KAAb,CAAmBL,IAAnB,EAAyBC,IAAzB,CAAb;oBACIT,QAAWQ,KAAKR,KAAhB,SAAyBQ,KAAK9C,IADlC;oBAEIwC,SAAA,CAAe7C,MAAf,CAAJ,EAA4B;2BACjBrB,IAAP,CAAY,gBAAQ;8BACVwE,IAAN,EAAYM,IAAZ,EAAkBlB,OAAlB,EAA2BC,OAA3B;qBADJ,EAEG5D,KAFH,CAES,iBAAS;4BACVU,MAAMoE,QAAN,CAAeC,KAAf,CAAJ,EAA2B;oCACf,QAAR;;gCAEI;mCACG,QADH;mCAEGhB,KAFH;kCAGEgB;yBAHV;qBANJ;iBADJ,MAaO;0BACGR,IAAN,EAAYnD,MAAZ,EAAoBuC,OAApB,EAA6BC,OAA7B;;aAjBD,CAAP;;;;;;AAuBRM,QAAQc,GAAR,GAAc,EAAd;;;AAGAd,QAAQc,GAAR,CAAY,MAAZ,IAAsB,IAAId,OAAJ,CAAY,MAAZ,EAAoB,QAApB,EAA8B,UAAUN,OAAV,EAAmB;QAC/DqB,UAAUrB,QAAQsB,cAAR,CAAuBC,IAArC;QACIF,WAAW,OAAOA,QAAQd,OAAf,KAA2B,UAA1C,EAAsD;eAC3Cc,QAAQd,OAAR,CAAgBP,QAAQwB,iBAAxB,EAA2CxB,QAAQyB,WAAnD,CAAP;KADJ,MAEO;eACI,IAAP;;CALc,EAOnB,IAPmB,EAOb,UAAUzB,OAAV,EAAmB;QACpBqB,UAAUrB,QAAQsB,cAAR,CAAuBC,IAArC;QACI,OAAOF,QAAQK,QAAf,KAA4B,UAAhC,EAA4C;gBAChCA,QAAR,CAAiB1B,QAAQwB,iBAAzB,EAA4CxB,QAAQyB,WAApD;;CAVc,CAAtB;;;AAeA,IAAIE,mBAAmB,IAAIrB,OAAJ,CAAY,WAAZ,EAAyB,QAAzB,EAAmC,UAAUN,OAAV,EAAmB;QACrE4B,gBAAgB5B,QAAQwB,iBAA5B;QACIK,QAAQ7B,QAAQ8B,cAAR,CAAuB/E,UAAvB,IAAqC,EADjD;QAEIgF,WAAW/B,QAAQsB,cAAR,CAAuBU,SAFtC;QAGIC,YAAYJ,MAAM7B,QAAQkC,WAAd,CAHhB;;qBAIqB,EAJrB;;QAMI,OAAOD,SAAP,KAAqB,UAAzB,EAAqC;uBAClBE,IAAf,CAAoBF,SAApB;KADJ,MAEO,IAAInD,MAAMC,OAAN,CAAckD,SAAd,CAAJ,EAA8B;yBAChBG,eAAeC,MAAf,CAAsBJ,SAAtB,CAAjB;;QAEA,OAAOF,QAAP,KAAoB,UAAxB,EAAoC;uBACjBI,IAAf,CAAoBJ,QAApB;KADJ,MAEO,IAAIjD,MAAMC,OAAN,CAAcgD,QAAd,CAAJ,EAA6B;yBACfK,eAAeC,MAAf,CAAsBN,QAAtB,CAAjB;KADG,MAEA,IAAI,QAAOA,QAAP,yCAAOA,QAAP,OAAoB,QAApB,IAAgCA,SAASO,OAAzC,IAAoDP,SAAShF,UAAjE,EAA6E;yBAC/DqF,eAAeC,MAAf,CAAsBN,SAAShF,UAAT,IAAuB,EAA7C,CAAjB;;;WAGG+D,QAAQyB,GAAR,CAAYH,eAAehB,GAAf,CAAmB,gBAAQ;YACtCoB,aAAahG,KAAKoF,aAAL,EAAoB5B,QAAQyB,WAA5B,CAAjB;YACIpB,SAAA,CAAemC,UAAf,CAAJ,EAAgC;mBACrBA,UAAP;SADJ,MAEO;mBACI1B,QAAQf,OAAR,CAAgByC,UAAhB,CAAP;;KALW,CAAZ,CAAP;CApBmB,EA4BpB,UAAUC,KAAV,EAAiBzC,OAAjB,EAA0B;QACrB+B,WAAW/B,QAAQsB,cAAR,CAAuBU,SAAtC;QACIU,eAAeX,SAASW,YAD5B;QAEI,OAAOA,YAAP,KAAwB,UAA5B,EAAwC;eAC7BA,aAAaD,KAAb,CAAP;KADJ,MAEO;eACI,IAAP;;CAlCe,EAoCpB,UAAUzC,OAAV,EAAmB;QACd+B,WAAW/B,QAAQsB,cAAR,CAAuBU,SAAtC;QACIW,YAAYZ,SAASY,SADzB;QAEI,OAAOA,SAAP,KAAqB,UAAzB,EAAqC;YAC7BC,gBAAgB5C,QAAQ6C,OAAR,CAAgBC,IAAhB,CAAqB;mBAAQtG,KAAK2D,KAAL,KAAe,kBAAvB;SAArB,CAApB;eACOwC,UAAUC,gBAAgBA,cAAc3B,IAA9B,GAAqCxD,SAA/C,CAAP;;CAzCe,CAAvB;AA4CA6C,QAAQc,GAAR,CAAYO,iBAAiB9D,IAA7B,IAAqC8D,gBAArC;;;AAGA,IAAMoB,gBAAgB,IAAIzC,OAAJ,CAAY,QAAZ,EAAsB,SAAtB,EAAiC,UAAUN,OAAV,EAAmB;QAClEgD,SAAShD,QAAQgD,MAArB;QACId,cAAclC,QAAQkC,WAD1B;QAEIN,gBAAgB5B,QAAQwB,iBAF5B;QAGIyB,cAAcjD,QAAQ8B,cAAR,CAAuBhF,KAHzC;QAIIE,WAAWgD,QAAQ8B,cAAR,CAAuB9E,QAJtC;;;QAOI,OAAOA,SAASkG,MAAhB,KAA2B,UAA/B,EAA2C;YACnCC,cAAcnG,SAASkG,MAAT,CAAgBtB,aAAhB,CAAlB;YACIuB,WAAJ,EAAiB;wBACDC,GAAZ,GAAkBD,cAAc,EAAhC;SADJ,MAEO;wBACSC,GAAZ,GAAkBxB,cAAcwB,GAAhC;;;QAGJ,CAACH,YAAYG,GAAb,IAAoBhE,OAAOX,SAAP,CAAiB4E,IAAjB,CAAsBhE,IAAtB,CAA2B4D,YAAYG,GAAvC,MAAgD,EAAxE,EAA4E;oBAC5DA,GAAZ,GAAkBlB,cAAc,EAAhC;;;;QAIAoB,oBAAoBxG,MAAMyG,WAAN,CAAkBC,MAAlB,EAAxB;gBACYC,WAAZ,GAA0BH,kBAAkBI,KAA5C;QACIC,eAAe3D,QAAQyB,WAAR,IAAuBzB,QAAQyB,WAAR,CAAoBpD,MAApB,GAA6B,CAApD,GAAwD2B,QAAQyB,WAAR,CAAoB,CAApB,CAAxD,GAAiF,EAApG;QACI,CAACwB,YAAYW,MAAZ,GAAqB,EAAtB,EAA0BnD,WAA1B,OAA4C,KAAhD,EAAuD;oBACvCoD,MAAZ,GAAqBZ,YAAYY,MAAZ,IAAsB,EAA3C;YACInH,QAAOuG,YAAYY,MAAnB,MAA8B,QAAlC,EAA4C;kBACxC,CAAY,IAAZ,EAAkBZ,YAAYY,MAA9B,EAAsCF,YAAtC;SADJ,MAEO,IAAI,OAAOV,YAAYY,MAAnB,KAA8B,QAAlC,EAA4C;wBACnCA,MAAZ,IAAsB,MAAMxD,gBAAA,CAAsBsD,YAAtB,CAA5B;;KALR,MAOO;YACC,OAAOA,YAAP,KAAwB,QAAxB,IAAoCA,gBAAgB,EAAxD,EAA4D;gBACpD,OAAOV,YAAYhC,IAAnB,KAA4B,QAAhC,EAA0C;4BAC1BA,IAAZ,IAAoB,MAAMZ,aAAA,CAAmBsD,YAAnB,CAA1B;aADJ,MAEO,IAAIjH,QAAOuG,YAAYhC,IAAnB,MAA4B,QAAhC,EAA0C;4BACjCA,IAAZ,GAAmBZ,aAAA,CAAmBsD,YAAnB,IAAmC,GAAnC,GAAyCA,YAA5D;aADG,MAEA;4BACS1C,IAAZ,GAAmB0C,YAAnB;;SANR,MAQO,IAAI,QAAOA,YAAP,yCAAOA,YAAP,OAAwB,QAA5B,EAAsC;gBACrCjH,QAAOuG,YAAYhC,IAAnB,MAA4B,QAAhC,EAA0C;sBACtC,CAAY,IAAZ,EAAkBgC,YAAYhC,IAA9B,EAAoC0C,YAApC;aADJ,MAEO,IAAI,OAAOV,YAAYhC,IAAnB,KAA4B,QAAhC,EAA0C;4BACjCA,IAAZ,IAAoB,MAAMZ,aAAA,CAAmBsD,YAAnB,CAA1B;aADG,MAEA;4BACS1C,IAAZ,GAAmB0C,YAAnB;;;;YAIJF,WAAR,GAAsBH,iBAAtB;;;WAGON,OAAOlG,KAAP,CAAagH,OAAb,CAAqBb,WAArB,CAAP;CArDkB,EAsDnB,UAAUc,GAAV,EAAe/D,OAAf,EAAwB;QACnBgE,qBAAqBhE,QAAQ8B,cAAR,CAAuB9E,QAAvB,CAAgCiD,WAAzD;QACIzC,SAAS,CAACwG,sBAAsB,YAAY;eAAS,IAAP;KAArC,EAAoDD,GAApD,CAAb;WACOvG,MAAP;CAzDkB,CAAtB;AA2DA8C,QAAQc,GAAR,CAAY2B,cAAclF,IAA1B,IAAkCkF,aAAlC;;AClMA,IAAIkB,iBAAiB,SAAjBA,cAAiB,OAAQ;WAClBhD,IAAP;CADJ;;AAIA,IAAIiD,aAAa,SAAbA,UAAa,CAACrG,IAAD,EAAOmC,OAAP,EAAmB;QAC5BhD,WAAWgD,QAAQ8B,cAAR,CAAuB9E,QAAtC;QACImH,UAAUnH,WAAWA,SAASa,IAAT,CAAX,GAA4B,IAD1C;cAEU,OAAOsG,OAAP,KAAmB,UAAnB,GAAgCA,OAAhC,GAA0CF,cAApD;WACOE,OAAP;CAJJ;;IAOqBC;uBACH;;;aACLC,KAAL,GAAa,EAAb;aACKrB,MAAL,GAAc,IAAd;aACKsB,YAAL,GAAoB,IAApB;aACKpC,WAAL,GAAmB,EAAnB;aACKT,WAAL,GAAmB,IAAnB;aACKP,QAAL,GAAgB,KAAhB;aACK2B,OAAL,GAAe,EAAf;aACKY,WAAL,GAAmB,IAAnB;;;;;8BAGE;;gBAEEzD,UAAU,IAAd;oBACQwB,iBAAR,GAA4BxB,QAAQgD,MAAR,CAAepF,OAAf,CAAuBf,iBAAvB,CAAyCmD,QAAQkC,WAAjD,CAA5B;oBACQJ,cAAR,GAAyBzB,MAAA,CAAY,IAAZ,EAAkB,EAAlB,EAAsBL,QAAQgD,MAAR,CAAepF,OAArC,EAA8CyC,yBAAA,CAA+BL,QAAQwB,iBAAvC,CAA9C,EAAyGxB,QAAQsE,YAAjH,EAA+HtE,QAAQuE,WAAvI,CAAzB;;qBAESC,aAAT,CAAuBC,QAAvB,EAAiC;oBACzBC,IAAI,IAAI5D,OAAJ,CAAY,UAAUf,OAAV,EAAmBgB,MAAnB,EAA2B;2BACpC0D,SAAS1E,OAAT,EAAkBgB,MAAlB,CAAP;iBADI,CAAR;;kBAIE4D,SAAF,GAAcH,cAAc/F,SAA5B;uBACOiG,CAAP;;0BAEUC,SAAd,GAA0B7D,OAA1B;0BACcrC,SAAd,CAAwBkG,SAAxB,GAAoC7D,QAAQrC,SAA5C;0BACcA,SAAd,CAAwBmG,MAAxB,GAAiC,UAAU3D,IAAV,EAAgB;uBACtCjB,QAAQ4E,MAAR,CAAe3D,IAAf,CAAP;aADJ;;gBAII4D,UAAU,IAAIL,aAAJ,CAAkB,UAACzE,OAAD,EAAUgB,MAAV,EAAqB;oBAC7C+D,cAAc9E,QAAQ8B,cAAR,CAAuBnF,QAAzC;oBACIO,OAAOsB,OAAOtB,IAAP,CAAY4H,WAAZ,EAAyBC,MAAzB,CAAgC,gBAAQ;wBAC3CC,IAAIF,YAAYjH,IAAZ,CAAR;2BACO,CAAC,CAACmH,EAAE1C,OAAX,CAF+C;iBAAxC,CAAX;oBAII3F,WAAWO,KAAKkE,GAAL,CAAS,gBAAQ;2BACrBd,QAAQc,GAAR,CAAYvD,IAAZ,CAAP;iBADW,EAEZkH,MAFY,CAEL,aAAK;2BACJ,CAAC,CAACC,CAAT;iBAHW,CAAf;yBAKS7C,IAAT,CAAc7B,QAAQc,GAAR,CAAY,QAAZ,CAAd;2BACWzE,SAASoI,MAAT,CAAgB;2BAAKC,EAAE7E,KAAF,KAAY,QAAjB;iBAAhB,EAA2CkC,MAA3C,CAAkD1F,SAASoI,MAAT,CAAgB;2BAAKC,EAAE7E,KAAF,KAAY,SAAjB;iBAAhB,CAAlD,EAA+FxD,SAASoI,MAAT,CAAgB;2BAAKC,EAAE7E,KAAF,KAAY,OAAjB;iBAAhB,CAA/F,CAAX;;;wBAGQ8E,gBAAR,GAA2BtI,QAA3B;wBACQ2E,cAAR,GAAyBwD,WAAzB;;yBAES3H,OAAT,CAAiB,sBAAc;4BACnB+H,GAAR,CAAY,UAAUC,IAAV,EAAgB;4BACpBnF,QAAQkB,QAAZ,EAAsB;mCACXgD,WAAW,eAAX,EAA4BlE,OAA5B,EAAqCA,QAAQ6C,OAA7C,EAAsD7C,QAAQwB,iBAA9D,CAAP;;;;mCAIO4D,IAAX,CAAgBpF,OAAhB,EAAyB7D,IAAzB,CAA8B,gBAAQ;oCAC1B0G,OAAR,CAAgBV,IAAhB,CAAqBlB,IAArB;gCACIA,KAAKoE,KAAL,KAAe,SAAnB,EAA8B;oCACtBC,WAAWC,eAAf,EAAgC;wCACxB,OAAOD,WAAWE,cAAlB,KAAqC,UAAzC,EAAqD;mDACtCA,cAAX,CAA0BxF,OAA1B;;4CAEIkE,WAAW,gBAAX,EAA6BlE,OAA7B,EAAsCiB,KAAKA,IAA3C,EAAiDjB,QAAQwB,iBAAzD,CAAR;iCAJJ,MAKO;wCACCxB,QAAQqE,KAAR,CAAchG,MAAd,GAAuB,CAA3B,EAA8B;;qCAA9B,MAEO;gDACK6F,WAAW,gBAAX,EAA6BlE,OAA7B,EAAsCiB,KAAKA,IAA3C,EAAiDjB,QAAQwB,iBAAzD,CAAR;;;6BAVZ,MAaO;oCACC,OAAO8D,WAAW9E,YAAlB,KAAmC,UAAvC,EAAmD;+CACpCA,YAAX,CAAwBR,OAAxB;;uCAEGkE,WAAW,eAAX,EAA4BlE,OAA5B,EAAqCA,QAAQ6C,OAA7C,EAAsD7C,QAAQwB,iBAA9D,CAAP;;yBAnBR;qBANJ;iBADJ;wBA+BQ2D,IAAR;aAjDU,CAAd;mBAmDON,OAAP;;;;+BAGG5D,MAAM;gBACL,KAAKC,QAAT,EAAmB;iBACdA,QAAL,GAAgB,IAAhB;gBACI,KAAKuC,WAAT,EAAsB;qBACbA,WAAL,CAAiBmB,MAAjB,CAAwB3D,IAAxB;;;;;4BAGJV,SAAS;gBACL,OAAOA,OAAP,KAAmB,UAAvB,EAAmC;iBAC9B8D,KAAL,CAAWlC,IAAX,CAAgB5B,OAAhB;;;;+BAGG;gBACC/D,OAAO,KAAK6H,KAAL,CAAWoB,KAAX,EAAX;gBACIjJ,IAAJ,EAAU;qBACD,KAAK2I,IAAL,CAAUO,IAAV,CAAe,IAAf,CAAL;;;;;;;AClHZ,2BAAe;uBACQ,EADR;WAEJ;;gBAEK,KAFL;0BAGerF,gBAHf;iBAIM;oBACG;gCACY;aAFf;kBAIC;gCACc;;SATrB;0BAYe,CAAC,UAAUY,IAAV,EAAgB0E,OAAhB,EAAyB;mBACjCtF,aAAA,CAAmBY,IAAnB,CAAP;SADc;KAdX;gBAkBC,EAlBD;cAmBD;cACA;qBACO;SAFP;eAIC;qBACM;SALP;mBAOK;qBACE,KADF;SAPL,EAnBC;cA8BD;;cAAA,kBAECW,aAFD,EAEgB;mBACXA,cAAcwB,GAArB;SAHE;;;mBAAA,uBAMMW,GANN,EAMWnC,aANX,EAM0B;mBACrBmC,OAAOA,IAAI9C,IAAX,GAAkB,IAAlB,GAAyB,KAAhC;SAPE;;;sBAAA,0BAUS8C,GAVT,EAUcnC,aAVd,EAU6B;mBACxBmC,IAAI9C,IAAX;SAXE;;;qBAAA,yBAcQ2E,aAdR,EAcuBhE,aAdvB,EAcsC;mBACjCgE,aAAP;;;CA7CZ;;ACIA;;;;;;;;;;;;;IAaMC;oBACUvJ,GAAZ,EAAiB;;;aACRwJ,EAAL,GAAU,CAACC,KAAKC,MAAL,KAAgB,EAAjB,EAAqBC,OAArB,CAA6B,IAA7B,EAAmC,EAAnC,CAAV;eACO7E,GAAP,CAAW,KAAK0E,EAAhB,IAAsB,IAAtB;;;aAGKhJ,KAAL,GAAaA,MAAMoJ,MAAN,EAAb;;aAEKtI,OAAL,GAAe,EAAf;aACKuI,UAAL,CAAgB7J,GAAhB;;;;;sCAEU4F,aAAaoC,cAAc;gBACjC8B,YAAY,IAAhB;;mBAEO,SAAStC,OAAT,CAAiBuC,KAAjB,EAAwB/J,GAAxB,EAA6B;oBAC5BmF,cAAc3C,MAAM+B,IAAN,CAAW1C,SAAX,CAAlB;oBACI6B,UAAU,IAAIoE,OAAJ,EADd;wBAEQpB,MAAR,GAAiBoD,SAAjB;wBACQ9B,YAAR,GAAuBA,YAAvB;wBACQC,WAAR,GAAsBjI,GAAtB;wBACQgK,SAAR,GAAoBD,KAApB;wBACQnE,WAAR,GAAsBA,WAAtB;wBACQT,WAAR,GAAsBA,WAAtB;wBACQP,QAAR,GAAmB,KAAnB;wBACQ2B,OAAR,GAAkB,EAAlB;wBACQY,WAAR,GAAsB,IAAtB;;uBAEOzD,QAAQuG,GAAR,EAAP;aAbJ;;;;mCAgBOjK,KAAK;gBACR,QAAOA,GAAP,yCAAOA,GAAP,OAAe,QAAnB,EAA6B;4BACzB,CAAkBA,GAAlB;uCACA,CAA6BA,GAA7B;sBACA,CAAY,IAAZ,EAAkB,KAAKsB,OAAvB,EAAgCtB,GAAhC;;;;;+BAGMA,KAAK;mBACR,IAAIuJ,MAAJ,CAAWxF,MAAA,CAAY,IAAZ,EAAkB,EAAlB,EAAsBmG,oBAAtB,EAA4ClK,GAA5C,CAAX,CAAP;;;;sCAEiB4F,aAAaoC,cAAc;mBACrCuB,OAAOzE,GAAP,CAAW,SAAX,EAAsBqF,aAAtB,CAAoCvE,WAApC,EAAiDoC,YAAjD,CAAP;;;;mCAEchI,KAAK;gBACf,QAAOA,GAAP,yCAAOA,GAAP,OAAe,QAAnB,EAA6B;4BACzB,CAAkBA,GAAlB;uCACA,CAA6BA,GAA7B;sBACA,CAAY,IAAZ,EAAkBkK,oBAAlB,EAAwClK,GAAxC;uBACO8E,GAAP,CAAW,SAAX,EAAsB+E,UAAtB,CAAiC7J,GAAjC;;;;;;;AAIZuJ,OAAOzE,GAAP,GAAa,EAAb;;AAEA,IAAIsF,gBAAgBb,OAAOK,MAAP,EAApB;AACAQ,cAAcZ,EAAd,GAAmB,SAAnB;AACAD,OAAOzE,GAAP,CAAW,SAAX,IAAwBsF,aAAxB;;;;;;;;"}